*filter

# Base Setting
:INPUT DROP [0:0]
:FORWARD DROP [0:0]
:OUTPUT ACCEPT [0:0]

# Accept loopback interface
-A INPUT -i lo -j ACCEPT

# Accept established packet
-A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT

# Accept ping packet
-A INPUT -p icmp -j ACCEPT

# Accept ssh access
-A INPUT -p tcp -m state --state NEW --dport={{common_ssh_port}} -j ACCEPT

# for IP Spoofing
# //privateIP
-A INPUT -s 10.0.0.0/8 -j DROP
-A INPUT -s 172.16.0.0/12 -j DROP
-A INPUT -s 192.168.0.0/16 -j DROP
# //local-loopback
-A INPUT -s 127.0.0.1/8 -j DROP
# //TEST-NET
-A INPUT -s 169.254.0.0/16 -j DROP
# //link-local
-A INPUT -s 192.0.2.0/24 -j DROP
# //classD
-A INPUT -s 224.0.0.0/4 -j DROP
# //classE
-A INPUT -s 240.0.0.0/5 -j DROP

# for Smurf Attack
-A INPUT -d 0.0.0.0/8 -j DROP
-A INPUT -d 254.255.255.255 -j DROP

# Accept Using port
# //Accept using port
-A INPUT -p tcp --dport=25 -j ACCEPT
-A INPUT -p tcp --dport=53 -j ACCEPT
-A INPUT -p udp --dport=53 -j ACCEPT
-A INPUT -p tcp --dport=80 -j ACCEPT
-A INPUT -p tcp --dport=443 -j ACCEPT
-A INPUT -p tcp --dport=3306 -j ACCEPT

{% for item in common_enable_ports %}
-A INPUT -p {{item.protocol}} --dport={{item.port}} -j ACCEPT

COMMIT
